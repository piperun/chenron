from_latest_tag = true
ignore_merge_commits = true
tag_prefix = "v"
branch_whitelist = ["main"]
monorepo_version_separator = "-"

[commit_types]
hotfix = { changelog_title = "Hotfixes", bump_patch = true }
chore = { changelog_title = "Chores", omit_from_changelog = true }
test = { changelog_title = "Tests", omit_from_changelog = true }
ci = { changelog_title = "CI", omit_from_changelog = true }
style = { changelog_title = "Style", omit_from_changelog = true }

[changelog]
path = "CHANGELOG.md"
template = "remote"
remote = "github.com"
owner = "piperun"
repository = "chenron-flutter"

[[changelog.authors]]
signature = "piperun"
username = "piperun"

[git_hooks.commit-msg]
script = "#!/bin/sh\nset -e\ncog verify --file $1"

[packages.chenron]
path = "apps/chenron"
changelog_path = "CHANGELOG.md"
public_api = true
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}+0/' pubspec.yaml",
  "grep -rl '  chenron:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  chenron: \\^.*/  chenron: ^{{version}}/'",
]

[packages.database]
path = "packages/database"
public_api = true
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  database:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  database: \\^.*/  database: ^{{version}}/'",
]

[packages.core]
path = "packages/core"
public_api = true
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  core:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  core: \\^.*/  core: ^{{version}}/'",
]

[packages.basedir]
path = "packages/basedir"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  basedir:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  basedir: \\^.*/  basedir: ^{{version}}/'",
]

[packages.cache_manager]
path = "packages/cache_manager"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  cache_manager:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  cache_manager: \\^.*/  cache_manager: ^{{version}}/'",
]

[packages.logger]
path = "packages/logger"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  logger:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  logger: \\^.*/  logger: ^{{version}}/'",
]

[packages.vibe]
path = "packages/vibe"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  vibe:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  vibe: \\^.*/  vibe: ^{{version}}/'",
]

[packages.web_archiver]
path = "packages/web_archiver"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  web_archiver:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  web_archiver: \\^.*/  web_archiver: ^{{version}}/'",
]

[packages.platform_provider]
path = "packages/platform_provider"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  platform_provider:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  platform_provider: \\^.*/  platform_provider: ^{{version}}/'",
]

[packages.chenron_mockups]
path = "packages/chenron_mockups"
public_api = false
pre_bump_hooks = [
  "sed -i 's/^version: .*/version: {{version}}/' pubspec.yaml",
  "grep -rl '  chenron_mockups:' ../.. --include=pubspec.yaml | xargs -r sed -i 's/  chenron_mockups: \\^.*/  chenron_mockups: ^{{version}}/'",
]
